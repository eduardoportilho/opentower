{"version":3,"sources":["webpack:///webpack/bootstrap 162ad9bd37a132612df5","webpack:///./src/image-cache.js","webpack:///./src/cell.js","webpack:///./src/geometry-utils.js","webpack:///./src/index.js","webpack:///./src/game.js","webpack:///./src/grid.js","webpack:///./src/coord.js","webpack:///./src/tower.js","webpack:///./src/drawing-utils.js","webpack:///./src/goon.js","webpack:///./src/path-finder.js","webpack:///./src/random.js","webpack:///./src/renderer.js"],"names":["loadImageCache","imageUrls","imageCache","onLoadComplete","key","url","img","Image","onload","Object","keys","length","src","CELL_EDGE_SIZE","Cell","row","col","coord","reachable","dist","undefined","nextStep","blocked","isTarget","equals","x","Math","round","y","pointInCell","zero","getTopLeftPosition","calculateDistance","pointA","pointB","dx","dy","sqrt","pow","getPointInLine","origin","anyPointInLine","distance","hyp","sin","cos","dyStep","dxStep","nextX","nextY","getAngleRadians","asin","init","canvas","document","getElementById","game","renderer","start","initCtrlPanel","onclick","e","stopPropagation","preventDefault","parseInt","value","spawnGoon","speed","goons","forEach","goon","isRunning","stop","Game","grid","width","height","pathFinder","towers","highlight","spawnedGoonCount","spawnCells","getSpawnCells","cash","updateCashDisplay","goonsInside","updateGoonsInsideDisplay","intervalId","window","setInterval","spawnGoons","bind","position","cost","towerCells","getCellsAround","rows","cols","some","cell","hasGoon","recalculate","doNotTrapCells","map","concat","isInvalidPosition","towerBoundaries","_getCellsBoudaries","tower","push","mousePosition","isOcuppied","boundaries","valid","NUMBER_OF_GOONS_TO_SPAWN","spawnCell","getRandomElementFromArray","bounty","removeGoon","index","findIndex","aGoon","id","splice","delta","update","updateHighlight","textContent","middle","rowCount","count","min","cells","get","topLeft","bottomRight","getBottomRightPosition","Grid","canvasSize","colCount","floor","Array","allCells","apply","any","filter","_isOutOfGrid","point","topLeftCell","getCellAtPosition","bottomRightCell","center","topRow","bottomRow","leftCol","rightCol","Coord","TOWER_SIZE","Tower","topLeftPosition","centerPosition","reloadTime","fireRange","damage","timeUntilReloaded","canonAngle","PI","context","fillStyle","strokeStyle","basePct","baseWidth","baseHeight","baseX","baseY","fillRect","strokeRect","rotPct","rotRadius","rotCenterX","rotCenterY","canonPct","canonWidth","canonHeight","canonX","canonY","save","translate","rotate","restore","isLoaded","shoot","reload","getClosestGoonInRange","life","towerCenter","goonsInRange","goonDist","sort","a","b","bottomRightPosition","buildSquarePath","roundRect","circle","startPosition","edgeSize","path","Path2D","startCorner","corners","moveTo","corner","lineTo","ctx","fill","stroke","radius","tl","tr","br","bl","defaultRadius","side","beginPath","quadraticCurveTo","closePath","arc","GOON_IMAGE_SIZE","Goon","initialCell","_residualStep","drawImage","drawLifeBar","greenWidth","max","redWidth","greenX","redX","updatePosition","updateLife","killGoon","nextCell","Error","offset","getOffset","targetPosition","step","intStep","nextPosition","nextPositionCell","goonArrived","PathFinder","reset","targetCell","getTarget","frontier","current","shift","neighboursCells","getUnvisitedNeighboursCells","neighbourCell","currentCell","steps","Random","yesChance","random","ceil","array","getRandomIntExclusive","currentIndex","temporaryValue","randomIndex","Renderer","getContext","animationId","onCanvasClick","onmousemove","onMouseMove","onmouseout","lastTick","Date","now","requestAnimationFrame","tick","render","clearRect","_paintBoundaries","draw","blockedCells","getCells","getBoundaries","event","clientX","target","offsetLeft","clientY","offsetTop","onUserClick","w","h"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 162ad9bd37a132612df5","/* global Image */\n\n/**\n * List of images to load.\n * @type {Object}\n */\nconst imageUrls = {\n  'tower-1': '../images/tower-1.png',\n  'goon-1': '../images/goon-1.png'\n}\n\n/**\n * Global image cache.\n * @type {Object}\n */\nexport const imageCache = {}\n\n/**\n * Load the images on the cache and call the callback when ready.\n * @param  {function} onLoadComplete\n */\nexport function loadImageCache (onLoadComplete) {\n  for (let key in imageUrls) {\n    let url = imageUrls[key]\n    let img = new Image()\n    img.onload = () => {\n      imageCache[key] = img\n      if (Object.keys(imageCache).length === Object.keys(imageUrls).length) {\n        onLoadComplete()\n      }\n    }\n    img.src = url\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/image-cache.js","/**\n * @typedef {Object} Point\n * @property {number} x - The X Coordinate.\n * @property {number} y - The Y Coordinate.\n */\n\nimport Coord from './coord'\n\n/**\n * Size of the (square) cell edge.\n * @type {number}\n */\nexport const CELL_EDGE_SIZE = 20\n\n/**\n * Grid cell.\n */\nexport class Cell {\n  /**\n   * @param {number} row - Row number.\n   * @param {number} col - Column number.\n   */\n  constructor (row, col) {\n    this.coord = new Coord(row, col)\n    this.reachable = false\n    this.dist = undefined\n    this.nextStep = undefined\n    this.blocked = false\n    this.isTarget = false\n  }\n\n  /**\n   * Check cell coordinates.\n   * @param {Coord} coord\n   * @return {Boolean}\n   */\n  isOnCoord (coord) {\n    return this.coord.equals(coord)\n  }\n\n  /**\n   * Get the position of the center of the cell in pixels.\n   * @return {Point}\n   */\n  getCenterPosition () {\n    let x = Math.round((this.coord.col * CELL_EDGE_SIZE) + (CELL_EDGE_SIZE / 2))\n    let y = Math.round((this.coord.row * CELL_EDGE_SIZE) + (CELL_EDGE_SIZE / 2))\n    return {x, y}\n  }\n\n  /**\n   * Get the top-left position of the cell in pixels.\n   * @return {Point}\n   */\n  getTopLeftPosition () {\n    let x = this.coord.col * CELL_EDGE_SIZE\n    let y = this.coord.row * CELL_EDGE_SIZE\n    return {x, y}\n  }\n\n  /**\n   * Get the bottom-right position of the cell in pixels.\n   * @return {Point}\n   */\n  getBottomRightPosition () {\n    let x = (this.coord.col + 1) * CELL_EDGE_SIZE\n    let y = (this.coord.row + 1) * CELL_EDGE_SIZE\n    return {x, y}\n  }\n\n  /**\n   * Get the offset of a point inside the cell from the cell's top-left corner.\n   * @param  {Point} pointInCell\n   * @return {Point} offset\n   */\n  getOffset (pointInCell) {\n    const zero = this.getTopLeftPosition()\n    return {\n      x: pointInCell.x - zero.x,\n      y: pointInCell.y - zero.y\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/cell.js","/**\n * Calculate the distance between 2 points.\n * @param  {Point} pointA\n * @param  {Point} pointB\n * @return {number} distance\n */\nexport const calculateDistance = (pointA, pointB) => {\n  const dx = pointB.x - pointA.x\n  const dy = pointB.y - pointA.y\n  return Math.sqrt(Math.pow(dx, 2) + Math.pow(dy, 2))\n}\n\n/**\n * Let L be the line formed by the 2 given points `origin` and `anyPointInLine`.\n * Return the point in L with the given distance to `origin`.\n * @param  {Point} origin - Origin point.\n * @param  {Point} anyPointInLine - Another poin in the desired line (define direction).\n * @param  {number} distance - Distance from origin to the returned point in pixels.\n * @return {Point} Point in L with the given distance to `origin`.\n */\nexport const getPointInLine = (origin, anyPointInLine, distance) => {\n  const hyp = calculateDistance(origin, anyPointInLine)\n  const dx = anyPointInLine.x - origin.x\n  const dy = anyPointInLine.y - origin.y\n  const sin = dy / hyp\n  const cos = dx / hyp\n\n  const dyStep = sin * distance\n  const dxStep = cos * distance\n\n  const nextX = origin.x + dxStep\n  const nextY = origin.y + dyStep\n  return {x: nextX, y: nextY}\n}\n\n/**\n * Return the angle between the line conecting 2 points and the horizontal axis.\n *\n * Angle signal:\n *  B     |     B\n *    (-) | (-)\n * -------A-------\n *    (+) | (+)\n *  B     |     B\n *\n * @param  {Point} pointA\n * @param  {Point} pointB\n * @return {number} Angle in radians.\n */\nexport const getAngleRadians = (pointA, pointB) => {\n  const dy = pointB.y - pointA.y\n  const hyp = calculateDistance(pointA, pointB)\n  const sin = dy / hyp\n  return Math.asin(sin)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/geometry-utils.js","import {loadImageCache} from './image-cache.js'\nimport Game from './game.js'\nimport Renderer from './renderer.js'\n\nloadImageCache(init)\n\nfunction init () {\n  const canvas = document.getElementById('canvas')\n  const game = new Game()\n  const renderer = new Renderer(canvas, game)\n  renderer.start()\n  initCtrlPanel(game, renderer)\n}\n\nfunction initCtrlPanel (game, renderer) {\n  document.getElementById('spawn').onclick = function (e) {\n    e.stopPropagation()\n    e.preventDefault()\n\n    const x = parseInt(document.getElementById('x').value)\n    const y = parseInt(document.getElementById('y').value)\n    game.spawnGoon(x, y)\n  }\n\n  document.getElementById('speedUpdate').onclick = function (e) {\n    e.stopPropagation()\n    e.preventDefault()\n\n    const speed = parseInt(document.getElementById('speed').value)\n    game.goons.forEach(goon => { goon.speed = speed })\n  }\n\n  document.getElementById('pause').onclick = function (e) {\n    e.stopPropagation()\n    e.preventDefault()\n\n    if (renderer.isRunning()) {\n      renderer.stop()\n    } else {\n      renderer.start()\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\n * @typedef {Object} Point\n * @property {number} x - The X Coordinate.\n * @property {number} y - The Y Coordinate.\n */\n\nimport Grid from './grid'\nimport {Tower, TOWER_SIZE} from './tower'\nimport Goon from './goon'\nimport PathFinder from './path-finder'\nimport random from './random'\n\nexport default class Game {\n  constructor () {\n    this.grid = new Grid({width: 1000, height: 600})\n    this.pathFinder = new PathFinder(this.grid)\n    this.towers = []\n    this.goons = []\n    this.highlight = undefined\n    this.spawnedGoonCount = 0\n    this.spawnCells = this.getSpawnCells()\n    this.cash = 50\n    this.updateCashDisplay()\n    this.goonsInside = 0\n    this.updateGoonsInsideDisplay()\n\n    this.intervalId = window.setInterval(this.spawnGoons.bind(this), 1500)\n  }\n\n  /**\n   * When a user click a cell.\n   * @param  {Point} position - Cell upper-left position.\n   */\n  onUserClick (position) {\n    if (this.cash < Tower.cost) {\n      // no money, no tower\n      return\n    }\n    const towerCells = this.grid.getCellsAround(position, TOWER_SIZE.rows, TOWER_SIZE.cols)\n    // occupied ?\n    if (!towerCells || towerCells.some(cell => cell.blocked || cell.hasGoon)) {\n      return\n    }\n    // 1: block\n    towerCells.forEach(cell => { cell.blocked = true })\n    // 2: recalculate paths\n    this.pathFinder.recalculate()\n    // 3: check for trapped goons and spawn locations\n    const doNotTrapCells = this.goons.map(goon => goon.cell)\n      .concat(this.spawnCells)\n    const isInvalidPosition = doNotTrapCells.some(cell => !cell.reachable)\n    // 4: if trapped, rollback\n    if (isInvalidPosition) {\n      towerCells.forEach(cell => { cell.blocked = false })\n      this.pathFinder.recalculate()\n      return\n    }\n\n    const towerBoundaries = this._getCellsBoudaries(towerCells)\n    const tower = new Tower(towerBoundaries, this)\n    this.towers.push(tower)\n    this.cash -= Tower.cost\n    this.updateCashDisplay()\n  }\n\n  onMouseMove (position) {\n    this.mousePosition = position\n  }\n\n  updateHighlight () {\n    if (!this.mousePosition) {\n      return\n    }\n    const towerCells = this.grid.getCellsAround(this.mousePosition, TOWER_SIZE.rows, TOWER_SIZE.cols)\n    if (!towerCells) {\n      this.highlight = undefined\n      return\n    }\n    const towerBoundaries = this._getCellsBoudaries(towerCells)\n    const isOcuppied = towerCells.some(cell => cell.blocked || cell.hasGoon)\n    this.highlight = {\n      boundaries: towerBoundaries,\n      valid: !isOcuppied\n    }\n  }\n\n  /**\n   * Spawn a new goon.\n   */\n  spawnGoon (goon) {\n    const NUMBER_OF_GOONS_TO_SPAWN = 5\n    const spawnCell = random.getRandomElementFromArray(this.spawnCells)\n    // TODO create method goon.setInitialCell\n    goon.cell = spawnCell\n    this.goons.push(goon)\n  }\n\n  killGoon (goon) {\n    this.cash += goon.bounty\n    this.removeGoon(goon)\n    this.updateCashDisplay()\n  }\n\n  goonArrived (goon) {\n    this.goonsInside++\n    this.updateGoonsInsideDisplay()\n    this.removeGoon(goon)\n  }\n\n  removeGoon (goon) {\n    const index = this.goons.findIndex((aGoon) => aGoon.id === goon.id)\n    if (index >= 0) {\n      this.goons.splice(index, 1)\n    }\n  }\n\n  /**\n   * Update the state of the game entities.\n   * @param  {number} delta - ms since last update.\n   */\n  update (delta) {\n    this.towers.forEach((tower) => tower.update(delta))\n    this.goons.forEach((goon) => goon.update(delta))\n    this.updateHighlight()\n  }\n\n  updateCashDisplay () {\n    document.getElementById('cash').textContent = this.cash\n  }\n\n  updateGoonsInsideDisplay () {\n    document.getElementById('goons-inside').textContent = this.goonsInside\n  }\n\n  getSpawnCells () {\n    const middle = Math.round(this.grid.rowCount / 2)\n    let count = Math.min(10, Math.round(this.grid.rowCount / 3))\n    let row = middle - Math.round(count / 2)\n    const cells = []\n    while (count-- > 0) {\n      cells.push(\n        this.grid.get(row++, 0)\n      )\n    }\n    return cells\n  }\n\n  _getCellsBoudaries (cells) {\n    return {\n      topLeft: cells[0].getTopLeftPosition(),\n      bottomRight: cells[cells.length - 1].getBottomRightPosition()\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/game.js","/**\n * @typedef {Object} CellData\n * @property {number} x - The X Coordinate.\n * @property {number} y - The Y Coordinate.\n * @property {number} dist - Number of steps until target.\n * @property {number} nextStep - Next cell on the path to target.\n */\n\nimport {Cell, CELL_EDGE_SIZE} from './cell'\n\nexport default class Grid {\n  constructor (canvasSize) {\n    this.canvasSize = canvasSize\n    this.colCount = Math.floor(canvasSize.width / CELL_EDGE_SIZE)\n    this.rowCount = Math.floor(canvasSize.height / CELL_EDGE_SIZE)\n    this.init()\n  }\n\n  init () {\n    this.grid = new Array(this.rowCount)\n    for (var row = 0; row < this.rowCount; row++) {\n      this.grid[row] = Array(this.colCount)\n      for (var col = 0; col < this.colCount; col++) {\n        this.grid[row][col] = new Cell(row, col)\n      }\n    }\n    // flatten all cells on a single array\n    this.allCells = [].concat.apply([], this.grid)\n  }\n\n  /**\n   * Reset grid data.\n   */\n  reset () {\n    for (var row = 0; row < this.rowCount; row++) {\n      for (var col = 0; col < this.colCount; col++) {\n        this.grid[row][col].reachable = false\n        this.grid[row][col].dist = undefined\n        this.grid[row][col].nextStep = undefined\n      }\n    }\n  }\n\n  /**\n   * Get cell at position.\n   * @param  {number} x - X coordinate.\n   * @param  {number} y - Y coordinate.\n   * @return {Cell}\n   */\n  get (row, col) {\n    try {\n      return this.grid[row][col]\n    } catch (any) {\n      return undefined\n    }\n  }\n\n  /**\n   * Get target cell.\n   * @return {Cell}\n   */\n  getTarget () {\n    let row = Math.round(this.rowCount / 2)\n    let col = this.colCount - 1\n    return this.get(row, col)\n  }\n\n  /**\n   * Get the unvisited neighbour cells of the position.\n   * @param  {Cell} cell\n   * @return {Cell[]}\n   */\n  getUnvisitedNeighboursCells (cell) {\n    const coord = cell.coord\n    const grid = this\n    return [\n      {row: coord.row, col: coord.col - 1},\n      {row: coord.row - 1, col: coord.col},\n      {row: coord.row, col: coord.col + 1},\n      {row: coord.row + 1, col: coord.col}\n    ].filter(coord => (\n      !this._isOutOfGrid(coord)\n    )).map(coord => (\n      grid.get(coord.row, coord.col)\n    )).filter(cell => (\n      cell.dist === undefined &&\n      !cell.blocked\n    ))\n  }\n\n  /**\n   * Get the cell that contains the provided position.\n   * @param  {Point} point\n   * @return {Cell}\n   */\n  getCellAtPosition (point) {\n    if (point.x < 0 ||\n      point.x > this.canvasSize.width ||\n      point.y < 0 ||\n      point.y > this.canvasSize.height\n    ) {\n      return undefined\n    }\n    const col = Math.floor(point.x / CELL_EDGE_SIZE)\n    const row = Math.floor(point.y / CELL_EDGE_SIZE)\n    return this.get(row, col)\n  }\n\n  /**\n   * Get the cells that contains the boundaries area.\n   * @param  {Boundaries} boundaries\n   * @return {Cell[]}\n   */\n  getCellsInBoundaries (boundaries) {\n    const topLeftCell = this.getCellAtPosition(boundaries.topLeft)\n    const bottomRightCell = this.getCellAtPosition(boundaries.bottomRight)\n    const cells = []\n    for (let row = topLeftCell.coord.row; row <= bottomRightCell.coord.row; row++) {\n      for (let col = topLeftCell.coord.col; col <= bottomRightCell.coord.col; col++) {\n        cells.push(this.get(row, col))\n      }\n    }\n    return cells\n  }\n\n  /**\n   * Return an array containing all cells.\n   * @return {Cell[]}\n   */\n  getCells () {\n    return this.allCells\n  }\n\n  /**\n   * Return a block of cells containg the point approximately in the center\n   * @param  {Point} point - Point contained in the block,\n   * @param  {number} rowCount - Number of rows in the block.\n   * @param  {number} colCount - Number of cols in the block.\n   * @return {Cell[]}\n   */\n  getCellsAround (point, rowCount, colCount) {\n    const center = this.getCellAtPosition(point)\n    if (!center) {\n      return undefined\n    }\n    const topRow = center.coord.row - Math.floor(rowCount / 2)\n    const bottomRow = topRow + rowCount - 1\n    const leftCol = center.coord.col - Math.floor(colCount / 2)\n    const rightCol = leftCol + colCount - 1\n    if (this._isOutOfGrid({row: topRow, col: leftCol}) ||\n      this._isOutOfGrid({row: bottomRow, col: rightCol})) {\n      return undefined\n    }\n\n    const cells = []\n    for (let row = topRow; row <= bottomRow; row++) {\n      for (let col = leftCol; col <= rightCol; col++) {\n        cells.push(this.get(row, col))\n      }\n    }\n    return cells\n  }\n\n  /**\n   * Check if a coordinate is out of the grid.\n   * @param  {Coord} coord\n   * @return {Boolean}       [description]\n   */\n  _isOutOfGrid (coord) {\n    return coord.col < 0 ||\n      coord.col >= this.colCount ||\n      coord.row < 0 ||\n      coord.row >= this.rowCount\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/grid.js","export default class Coord {\n  /**\n   * @param {number} row\n   * @param {number} col\n   */\n  constructor (row, col) {\n    this.row = row\n    this.col = col\n  }\n\n  /**\n   * Compare two coordinates.\n   * @param {Coord} coord\n   * @return {Boolean}\n   */\n  equals (coord) {\n    return coord && this.row === coord.row && this.col === coord.col\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/coord.js","import {calculateDistance, getAngleRadians} from './geometry-utils'\nimport {roundRect, circle} from './drawing-utils'\n/**\n * @typedef {Object} Point\n * @property {number} x - The X Coordinate.\n * @property {number} y - The Y Coordinate.\n */\n\n/**\n * @typedef {Object} Boundaries\n * @property {Point} topLeft - top-left point of the object.\n * @property {Point} bottomRight - bottom-right point of the object.\n */\nexport const TOWER_SIZE = {\n  rows: 2,\n  cols: 2\n}\n\nexport class Tower {\n  constructor (boundaries, game) {\n    this.game = game\n    this.topLeftPosition = boundaries.topLeft\n    this.width = boundaries.bottomRight.x - boundaries.topLeft.x\n    this.height = boundaries.bottomRight.y - boundaries.topLeft.y\n    this.centerPosition = {\n      x: Math.round(boundaries.topLeft.x + (this.width / 2)),\n      y: Math.round(boundaries.topLeft.y + (this.height / 2))\n    }\n    // shooting consts\n    this.reloadTime = 2000\n    this.fireRange = 150\n    this.damage = 5\n\n    // shoting props\n    this.timeUntilReloaded = 0\n    this.canonAngle = Math.PI\n  }\n\n  /**\n   * Draw the tower on position.\n   * @param  {CanvasRenderingContext2D} context - Canvas renderering context.\n   */\n  draw (context) {\n    // grass\n    let x = this.topLeftPosition.x\n    let y = this.topLeftPosition.y\n    let width = this.width\n    let height = this.height\n    context.fillStyle = '#B8E986'\n    context.strokeStyle = '#7ED321'\n    roundRect(context, x, y, width, height, true, true)\n\n    // base\n    const basePct = 3 / 5\n    const baseWidth = Math.round(width * basePct)\n    const baseHeight = Math.round(height * basePct)\n    const baseX = x + Math.round((width - baseWidth) / 2)\n    const baseY = y + Math.round((height - baseHeight) / 2)\n    context.fillStyle = '#D3D3D3'\n    context.strokeStyle = '#979797'\n    context.fillRect(baseX, baseY, baseWidth, baseHeight)\n    context.strokeRect(baseX, baseY, baseWidth, baseHeight)\n\n    // Rotatory device\n    const rotPct = 2 / 5\n    const rotRadius = Math.round(width * rotPct / 2)\n    const rotCenterX = x + Math.round(width / 2)\n    const rotCenterY = y + Math.round(height / 2)\n    context.fillStyle = '#9B9B9B'\n    context.strokeStyle = '#979797'\n    circle(context, rotCenterX, rotCenterY, rotRadius, true, true)\n\n    // canon\n    const canonPct = 22 / 50\n    const canonWidth = Math.round(width * canonPct)\n    const canonHeight = 8\n    const canonX = 0\n    const canonY = 0 - Math.round(canonHeight / 2)\n    context.save()\n    context.translate(rotCenterX, rotCenterY)\n    context.rotate(this.canonAngle)\n    context.fillStyle = '#9B9B9B'\n    context.strokeStyle = '#979797'\n    context.fillRect(canonX, canonY, canonWidth, canonHeight)\n    context.restore()\n  }\n\n  /**\n   * Update tower state.\n   * @param  {number} delta - ms since last update.\n   */\n  update (delta) {\n    if (this.isLoaded()) {\n      this.shoot()\n    } else {\n      this.reload(delta)\n    }\n  }\n\n  reload (delta) {\n    this.timeUntilReloaded -= delta\n  }\n\n  shoot () {\n    const goon = this.getClosestGoonInRange()\n    if (goon) {\n      goon.life -= this.damage\n      this.timeUntilReloaded = this.reloadTime\n      this.canonAngle = getAngleRadians(this.centerPosition, goon.position)\n      if (goon.position.x < this.centerPosition.x) {\n        this.canonAngle = Math.PI - this.canonAngle\n      }\n    }\n  }\n\n  isLoaded () {\n    return this.timeUntilReloaded <= 0\n  }\n\n  getClosestGoonInRange () {\n    let towerCenter = this.centerPosition\n    const goonsInRange = this.game.goons\n      .map(goon => {\n        const dist = calculateDistance(towerCenter, goon.position)\n        return {goon, dist}\n      })\n      .filter(goonDist => goonDist.dist <= this.fireRange)\n      .sort((a, b) => a.dist - b.dist)\n    return goonsInRange.length > 0 ? goonsInRange[0].goon : undefined\n  }\n\n  /**\n   * Get to top-left and bottom-right points of the tower.\n   * @return {Boundaries}\n   */\n  getBoundaries () {\n    return {\n      'topLeft': this.topLeftPosition,\n      'bottomRight': this.bottomRightPosition\n    }\n  }\n}\nTower.cost = 10\n\n\n\n// WEBPACK FOOTER //\n// ./src/tower.js","/* global Path2D */\n\n/**\n * @typedef {Object} Point\n * @property {number} x - The X Coordinate.\n * @property {number} y - The Y Coordinate.\n */\n\n/**\n * Build a square path.\n * @param  {Point} startPosition\n * @param  {number} edgeSize\n * @return {Path2D}\n */\nexport function buildSquarePath (startPosition, edgeSize) {\n  const path = new Path2D()\n  const startCorner = [startPosition.x, startPosition.y]\n  const corners = [\n    [startPosition.x + edgeSize, startPosition.y],\n    [startPosition.x + edgeSize, startPosition.y + edgeSize],\n    [startPosition.x, startPosition.y + edgeSize],\n    [startPosition.x, startPosition.y]\n  ]\n  path.moveTo(...startCorner)\n  corners.forEach((corner) => {\n    path.lineTo(...corner)\n  })\n  return path\n}\n\n/**\n * Draws a rounded rectangle using the current state of the canvas.\n * If you omit the last three params, it will draw a rectangle\n * outline with a 5 pixel border radius\n * @param {CanvasRenderingContext2D} ctx\n * @param {Number} x The top left x coordinate\n * @param {Number} y The top left y coordinate\n * @param {Number} width The width of the rectangle\n * @param {Number} height The height of the rectangle\n * @param {Boolean} [fill = false] Whether to fill the rectangle.\n * @param {Boolean} [stroke = true] Whether to stroke the rectangle.\n * @param {Number} [radius = 5] The corner radius; It can also be an object\n *                 to specify different radii for corners\n * @param {Number} [radius.tl = 0] Top left\n * @param {Number} [radius.tr = 0] Top right\n * @param {Number} [radius.br = 0] Bottom right\n * @param {Number} [radius.bl = 0] Bottom left\n */\nexport function roundRect (ctx, x, y, width, height, fill, stroke, radius) {\n  if (typeof stroke === 'undefined') {\n    stroke = true\n  }\n  if (typeof radius === 'undefined') {\n    radius = 5\n  }\n  if (typeof radius === 'number') {\n    radius = {tl: radius, tr: radius, br: radius, bl: radius}\n  } else {\n    const defaultRadius = {tl: 0, tr: 0, br: 0, bl: 0}\n    for (var side in defaultRadius) {\n      radius[side] = radius[side] || defaultRadius[side]\n    }\n  }\n  ctx.beginPath()\n  ctx.moveTo(x + radius.tl, y)\n  ctx.lineTo(x + width - radius.tr, y)\n  ctx.quadraticCurveTo(x + width, y, x + width, y + radius.tr)\n  ctx.lineTo(x + width, y + height - radius.br)\n  ctx.quadraticCurveTo(x + width, y + height, x + width - radius.br, y + height)\n  ctx.lineTo(x + radius.bl, y + height)\n  ctx.quadraticCurveTo(x, y + height, x, y + height - radius.bl)\n  ctx.lineTo(x, y + radius.tl)\n  ctx.quadraticCurveTo(x, y, x + radius.tl, y)\n  ctx.closePath()\n  if (fill) {\n    ctx.fill()\n  }\n  if (stroke) {\n    ctx.stroke()\n  }\n}\n\nexport function circle (ctx, x, y, radius, fill, stroke) {\n  ctx.beginPath()\n  ctx.arc(x, y, radius, 0, 2 * Math.PI)\n  fill && ctx.fill()\n  stroke && ctx.stroke()\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/drawing-utils.js","import {imageCache} from './image-cache.js'\nimport {getPointInLine} from './geometry-utils'\n\nconst GOON_IMAGE_SIZE = {\n  width: 14,\n  height: 20\n}\n\nexport default class Goon {\n  constructor (id, initialCell, game) {\n    this.id = id\n    this.game = game\n    this.pathFinder = this.game.pathFinder\n    this.cell = initialCell\n    this.cell.hasGoon = true\n    this.position = this.cell.getTopLeftPosition()\n    this.speed = 20 // px/sec\n    this.life = 100\n    this.bounty = 20\n\n    // store the decimals lost in the last step to maintain constant speed\n    this._residualStep = 0\n  }\n\n  /**\n   * Draw the goon on position.\n   * @param  {CanvasRenderingContext2D} context - Canvas renderering context.\n   */\n  draw (context) {\n    // _Paint cell base:\n    // context.fillStyle = 'gold'\n    // const cellOrigin = this.cell.getTopLeftPosition()\n    // context.fillRect(cellOrigin.x, cellOrigin.y, CELL_EDGE_SIZE, CELL_EDGE_SIZE)\n\n    const img = imageCache['goon-1']\n    context.drawImage(img, this.position.x, this.position.y - Math.round(GOON_IMAGE_SIZE.height / 2))\n    this.drawLifeBar(context)\n  }\n\n  drawLifeBar (context) {\n    const height = 4\n    const width = 20\n    const greenWidth = Math.max(0, Math.round(width * this.life / 100))\n    const redWidth = width - greenWidth\n\n    const y = this.position.y - 20\n    const greenX = this.position.x\n    const redX = this.position.x + greenWidth\n\n    context.fillStyle = 'green'\n    context.fillRect(greenX, y, greenWidth, height)\n    context.fillStyle = 'red'\n    context.fillRect(redX, y, redWidth, height)\n  }\n\n  /**\n   * Update goon state.\n   * @param  {number} delta - ms since last update.\n   */\n  update (delta) {\n    this.updatePosition(delta)\n    this.updateLife(delta)\n  }\n\n  updateLife (delta) {\n    if (this.life <= 0) {\n      this.game.killGoon(this)\n    }\n  }\n\n  updatePosition (delta) {\n    this.cell.hasGoon = false\n    const nextCell = this.pathFinder.nextCell(this.cell, 1)\n    if (!nextCell) {\n      throw new Error('Goon traped!')\n      //this.game.goonArrived(this)\n      //return\n    }\n\n    const offset = this.cell.getOffset(this.position)\n    const targetPosition = {\n      x: nextCell.getTopLeftPosition().x + offset.x,\n      y: nextCell.getTopLeftPosition().y + offset.y\n    }\n\n    const step = (this.speed * delta / 1000.0) + this._residualStep\n    const intStep = Math.floor(step)\n    this._residualStep = step - intStep\n\n    const nextPosition = getPointInLine(this.position, targetPosition, intStep)\n    // Might happen that step is not enought to change cell\n    const nextPositionCell = this.game.grid.getCellAtPosition(nextPosition)\n\n    if (nextPositionCell.isTarget) {\n      this.game.goonArrived(this)\n    } else {\n      this.cell = nextPositionCell\n      this.cell.hasGoon = true\n      this.position = nextPosition\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/goon.js","\nexport default class PathFinder {\n  constructor (grid) {\n    this.grid = grid\n    this.recalculate()\n  }\n\n  /**\n   * Recalculate all paths\n   */\n  recalculate () {\n    this.grid.reset()\n    let targetCell = this.grid.getTarget()\n    targetCell.dist = 0\n    targetCell.reachable = true\n    targetCell.isTarget = true\n    targetCell.nextStep = undefined\n    this.frontier = [targetCell]\n\n    while (this.frontier.length > 0) {\n      let current = this.frontier.shift()\n      let neighboursCells = this.grid.getUnvisitedNeighboursCells(current)\n      for (let neighbourCell of neighboursCells) {\n        neighbourCell.dist = current.dist + 1\n        neighbourCell.reachable = true\n        neighbourCell.nextStep = current\n        this.frontier.push(neighbourCell)\n      }\n    }\n  }\n\n  /**\n   * Get the next position in the path to the target.\n   * @param  {Point} currentPosition - Current position.\n   * @param  {Number} steps - Number of steps to perform.\n   * @return {Point}\n   */\n  nextCell (currentCell, steps = 1) {\n    let nextCell = currentCell.nextStep\n    while (--steps > 0 && nextCell) {\n      nextCell = nextCell.nextStep\n    }\n    return nextCell\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/path-finder.js","class Random {\n  yesOrNo (yesChance) {\n    yesChance = yesChance || 0.5\n    return Math.random() < yesChance\n  }\n\n  getRandomIntExclusive (min, max) {\n    min = Math.ceil(min)\n    max = Math.floor(max)\n    // The maximum is exclusive and the minimum is inclusive\n    return Math.floor(Math.random() * (max - min)) + min\n  }\n\n  getRandomIntInclusive (min, max) {\n    min = Math.ceil(min)\n    max = Math.floor(max)\n    // The maximum is inclusive and the minimum is inclusive\n    return Math.floor(Math.random() * (max - min + 1)) + min\n  }\n\n  getRandomElementFromArray (array) {\n    var index = this.getRandomIntExclusive(0, array.length)\n    return array[index]\n  }\n\n  shuffle (array) {\n    let currentIndex = array.length\n    let temporaryValue, randomIndex\n\n    // While there remain elements to shuffle...\n    while (currentIndex !== 0) {\n      // Pick a remaining element...\n      randomIndex = Math.floor(Math.random() * currentIndex)\n      currentIndex -= 1\n\n      // And swap it with the current element.\n      temporaryValue = array[currentIndex]\n      array[currentIndex] = array[randomIndex]\n      array[randomIndex] = temporaryValue\n    }\n  }\n}\n\nexport default new Random()\n\n\n\n// WEBPACK FOOTER //\n// ./src/random.js","/* global requestAnimationFrame */\n\n/**\n * @typedef {Object} Point\n * @property {number} x - The X Coordinate.\n * @property {number} y - The Y Coordinate.\n */\n\nimport {CELL_EDGE_SIZE} from './cell'\n\nclass Renderer {\n  /**\n   * Grid constructor\n   * @param  {HTMLCanvasElement} canvas - HTML canvas.\n   */\n  constructor (canvas, game) {\n    this.canvas = canvas\n    this.game = game\n    this.canvas.width = this.game.grid.canvasSize.width\n    this.canvas.height = this.game.grid.canvasSize.height\n    this.context = this.canvas.getContext('2d')\n    this.animationId = null\n\n    // bind events\n    this.canvas.onclick = this.onCanvasClick.bind(this)\n    this.canvas.onmousemove = this.onMouseMove.bind(this)\n    this.canvas.onmouseout = this.onMouseMove.bind(this)\n  }\n\n  /**\n   * Start the game loop.\n   */\n  start () {\n    this.lastTick = Date.now()\n    this.animationId = requestAnimationFrame(this.tick.bind(this))\n  }\n\n  stop () {\n    this.animationId = null\n  }\n\n  isRunning () {\n    return this.animationId !== null\n  }\n\n  /**\n   * Update state, render and restart the game loop every X ms.\n   */\n  tick () {\n    if (!this.animationId) {\n      return\n    }\n\n    const now = Date.now()\n    const delta = (now - this.lastTick)\n\n    this.game.update(delta)\n    this.lastTick = now\n\n    this.render()\n    this.animationId = requestAnimationFrame(this.tick.bind(this))\n  }\n\n  /**\n   * Draw the grid.\n   */\n  render () {\n    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height)\n    // 0: highlight\n    if (this.game.highlight) {\n      let stroke = 'green'\n      let fill = 'lightgreen'\n      if (!this.game.highlight.valid) {\n        stroke = 'red'\n        fill = 'lightcoral'\n      }\n      this._paintBoundaries(this.game.highlight.boundaries, stroke, fill)\n    }\n\n    // 1st layer: towers\n    this.game.towers.forEach((tower) => {\n      tower.draw(this.context)\n    })\n\n    // 2nd layer: goons\n    this.game.goons.forEach((goon) => {\n      goon.draw(this.context)\n    })\n  }\n\n  /**\n   * DEBUG: paint a blue square on blocked cells\n   */\n  paintBlockedCells () {\n    this.context.fillStyle = 'lightskyblue'\n    this.context.strokeStyle = 'azure'\n    const blockedCells = this.game.grid.getCells().filter((cell) => cell.blocked)\n    blockedCells.forEach((cell) => {\n      let position = cell.getTopLeftPosition()\n      this.context.strokeRect(position.x, position.y, CELL_EDGE_SIZE, CELL_EDGE_SIZE)\n      this.context.fillRect(position.x, position.y, CELL_EDGE_SIZE, CELL_EDGE_SIZE)\n    })\n\n    this.game.towers.forEach((tower) => {\n      this._paintBoundaries(tower.getBoundaries(), 'red')\n    })\n  }\n\n  /**\n   * Trigger onclick on canvas click.\n   * @param {MouseEvent} event\n   */\n  onCanvasClick (event) {\n    var mousePosition = {\n      x: event.clientX - event.target.offsetLeft,\n      y: event.clientY - event.target.offsetTop\n    }\n    this.game.onUserClick(mousePosition)\n  }\n\n  onMouseMove (event) {\n    var mousePosition = {\n      x: event.clientX - event.target.offsetLeft,\n      y: event.clientY - event.target.offsetTop\n    }\n    this.game.onMouseMove(mousePosition)\n  }\n\n  _paintBoundaries (boundaries, stroke, fill) {\n    let position = boundaries.topLeft\n    let w = boundaries.bottomRight.x - position.x\n    let h = boundaries.bottomRight.y - position.y\n    if (stroke) {\n      this.context.strokeStyle = stroke\n      this.context.strokeRect(position.x, position.y, w, h)\n    }\n    if (fill) {\n      this.context.fillStyle = fill\n      this.context.fillRect(position.x, position.y, w, h)\n    }\n  }\n}\n\nexport default Renderer\n\n\n\n// WEBPACK FOOTER //\n// ./src/renderer.js"],"sourceRoot":""}